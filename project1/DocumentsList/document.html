<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Communication Application Document</title>
    <!-- bootstrap css link -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- bootstrap js link -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <!-- font awesome cdn -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="document.css" />
  </head>

  <body>
    <!-- header part -->
    <div class="container">
      <div class="row">
        <div class="col">
          <a href="../GroupChatPage/chat.html">Group Chat</a>
        </div>
        <div class="col">
          <a href="../UserListPage/users.html">Manage Users</a>
        </div>
        <div class="col">
          <a href="../DocumentsList/document.html">Manage Documents</a>
        </div>
        <div class="col">
          <a href='../LogoutPage/logout.html' onclick="loggedOut()">Logout</a>
        </div>
      </div>
    </div>
    <!-- <button type="button" class="btn btn-primary"><a href="/DocumentsList/document.html">rehi</a></button> -->
    <h3 class="head">My Uploads</h3>
    <!-- container -->
    <div class="cont">
      <table class="table">
        <thead>
          <tr class="changeColour">
            <th scope="col">Label</th>
            <th scope="col" class="userId">File Name</th>
            <th class="userId">Action</th>
          </tr>
        </thead>
        <tbody class="changeColour2" id="documenttable"></tbody>
      </table>
    </div>
    <h3 class="head">Shared Uploads</h3>

    <!-- another container -->
    <div class="cont">
      <table class="table">
        <thead>
          <tr class="changeColour">
            <th scope="col">Label</th>
            <th scope="col" class="userId">File Name</th>
            <th class="userId">Shared by</th>
          </tr>
        </thead>
        <tbody class="changeColour2">
          <tr>
            <th scope="row">Sales Team Attendance Sept 2014</th>
            <td>Sale-Attend-Sep2014.xls</td>
            <td>anne.hunter@mail.com</td>
          </tr>
          <tr>
            <th scope="row">Office Rules</th>
            <td>OfficeRule.doc</td>
            <td>hr@office.com</td>
          </tr>
          <tr>
            <th scope="row"></th>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th scope="row"></th>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
      <div class="add-upload">
        <button
          class="button1"
          data-bs-toggle="modal"
          data-bs-target="#staticBackdrop"
          id="btn1"
        >
          <i class="fa fa-plus" aria-hidden="true"></i
          ><a href=""> Add upload</a>
        </button>
      </div>
    </div>
    <!-- Modal for upload-->
    <div
      class="modal fade"
      id="staticBackdrop"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Upload</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div>
              <label for="">File Description</label>
              <input
                type="text"
                id="documentM"
                value="Sample File"
                class="sample"
              />
            </div>
            <div class="file">
              <label for="">File Upload</label>
              <input type="file" class="choose" id="documentA" />
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
              onclick="uploadNow()"
            >
              Upload Now
            </button>
            <button type="button" class="btn btn-primary">Cancel</button>
          </div>
        </div>
      </div>
    </div>
    <!-- another modal for edit -->
    <div
      class="modal fade"
      id="editBackdrop"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="staticBackdropLabel">Edit</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div>
                <label for="">File Description</label>
                <input
                  type="text"
                  id="fileD"
                  value="Sales Report"
                  class="sales"
                />
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary save-btn"
                data-bs-dismiss="modal"
                onclick="editFile()"
              >
                Save
              </button>
              <button type="button" class="btn btn-secondary">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- modal for delete -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">
                Confirm User Deletion
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <img src="../image/questionMark.png" alt="loading" />
              <strong>Are You Sure?</strong>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                ok
              </button>
              <button type="button" class="btn btn-primary">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      var documents = JSON.parse(localStorage.getItem("documentList"))
        ? JSON.parse(localStorage.getItem("documentList"))
        : [];
      function uploadNow() {
        var documentBox = document.getElementById("documentM").value;
        var documentActual = document.getElementById("documentA").value;
        console.log(documentBox);
        var newDocument = {
          id: Number(new Date()),
          documentBox: documentBox,
          documentActual: documentActual,
        };
        documents.push(newDocument);
        var documentString = JSON.stringify(documents);
        localStorage.setItem("documentList", documentString);
      }
      console.log(documents);
      var content = "";
      for (i = 0; i < documents.length; i++) {
        //    console.log("heloo")line 326->data-bs-toggle="modal" data-bs-target="#exampleModal"
        content += "<tr>";
        content += "<th>" + documents[i].documentBox + "</th>";
        content += "<td>" + documents[i].documentActual + "</td>";
        content +=
          "<td> " +
          `<a href="./edit-document.html?id=${documents[i].id}">Edit</a>|
              <a href="./delete-document.html?id=${documents[i].id}">Delete</a>
              | <a href="../SharePage/share.html?id=${documents[i].id}">Share</a>` +
          "</td>";
        content += "</tr>";
      }
      document.getElementById("documenttable").innerHTML = content;

      var logggedInUser = localStorage.getItem("loggedIn");
      console.log(logggedInUser);
      var users = JSON.parse(localStorage.getItem("usersList"));
      console.log(users);
      var temp = [];

      function loggedOut() {
        console.log(logggedInUser);
        var itemToRemoveIndex = users.findIndex(function (item) {
          return item.email == logggedInUser;
        });

        // proceed to remove an item only if it exists.
        if (itemToRemoveIndex !== -1) {
          users.splice(itemToRemoveIndex, 1);
        }
        console.log(users);
        temp = users.map((a) => {
          return { ...a };
        });
        logggedInUser = "";
        console.log(temp);
        localStorage.setItem("usersList", JSON.stringify(temp));
        localStorage.setItem("loggedIn", JSON.stringify(logggedInUser));
      }
    </script>
  </body>
</html>
