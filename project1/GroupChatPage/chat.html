<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Communication Application Chat</title>
    <!-- bootstarp css link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- bootstrap js link -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
        <!-- <script>
            // var chat = document.getElementById("chatM").value;
            
            // console.log(localStorage)
            var users = JSON.parse(localStorage.getItem("usersList"));
      console.log(users);
      var logggedInUser = localStorage.getItem("loggedIn");
      console.log(logggedInUser);
            var userExists = users.some((user) => user.email === logggedInUser);
      var selectedData =
        users[
          users
            .map(function (item) {
              return item.email;
            })
            .indexOf(logggedInUser) 
        ];
      console.log(selectedData.name);
      console.log(new Date().toLocaleString().replace(",", ""));
      var chats = JSON.parse(localStorage.getItem("chatList")) ? JSON.parse(localStorage.getItem("chatList")) : [];
      function messgaeStore(){
        //   console.log("Hello")
          
          var inputBox = document.getElementById("chatM").value;
          var newChat = {
              "inputBox":inputBox,
              "time":new Date().toLocaleString().replace(",", "")
          }
          chats.push(newChat);
          var chatString = JSON.stringify(chats);
            localStorage.setItem("chatList", chatString);
          
      }
      console.log(chats);
       var content = "";
       for(i=0;i<chats.length;i++){
        //    console.log("heloo")
            content+= "<tr>";
            content+="<td>" + "["+ chats[i].time + "]" +"</td>";
            content+="<td>" + selectedData.name + ": " +"</td>";
            content+="<td> " + chats[i].inputBox +"</td>";
            content+= "<tr>";
       }
       document.getElementById("tabledata").innerHTML = content
        </script> -->
    <!-- font awesome cdn -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="chat.css">
</head>

<body>
    <!-- container -->
    <div class="container">
        <div class="row">
            <div class="col">
                <a href="../GroupChatPage/chat.html">Group Chat</a>
            </div>
            <div class="col">
                <a href="../UserListPage/users.html">Manage Users</a>
            </div>
            <div class="col">
                <a href="../DocumentsList/document.html">Manage Documents</a>
            </div>
            <div class="col">
                <a href="../LogoutPage/logout.html">Logout</a>
            </div>
        </div>
    </div>
    <!-- group chat header -->
    <div class="head">
        <p><strong>Group Chat</strong><i class="fa fa-times" aria-hidden="true"></i></p>
    </div>
    <div class="cont2">
        <table class="tabData">
            <tbody id="tabledata">

            </tbody>
            <!-- <tr>
                <td>[2013-01-27 01:00:16]</td>
                <td>Text User : </td>
                <td>Lorem ipsum dolor sit amet consectetur adipisicing elit.</td>
            </tr>
            <tr>
                <td>[2013-01-27 01:05:22]</td>
                <td>Text User : </td>
                <td>Lorem ipsum dolor sit amet consectetur adipisicing elit.</td>
            </tr>
            <tr>
                <td>2013-01-27 01:11:14]</td>
                <td>Anne Hunter : </td>
                <td>Lorem ipsum dolor sit amet consectetur adipisicing elit.</td>
            </tr>
            <tr>
                <td>[2013-01-27 02:11:35]</td>
                <td>Jack Washk : </td>
                <td>Lorem ipsum dolor sit amet consectetur adipisicing elit.</td>
            </tr> -->
        </table>
    </div>
    <!-- container3 -->
    <div class="cont3">
        <table class="message">
            <tr>
                <th>Anne Hunter</th>
                <th class="message1"><input type="text" id="chatM" value="I am good"></th>
                <th><button onclick="messgaeStore()">Send</button></th>
                <th><button onclick="location.reload()">Refersh</button></th>
            </tr>
        </table>
    </div>
    <script>
        // var chat = document.getElementById("chatM").value;
        
        // console.log(localStorage)
        var users = JSON.parse(localStorage.getItem("usersList"));
  console.log(users);
  var logggedInUser = localStorage.getItem("loggedIn");
  console.log(logggedInUser);
        var userExists = users.some((user) => user.email === logggedInUser);
  var selectedData =
    users[
      users
        .map(function (item) {
          return item.email;
        })
        .indexOf(logggedInUser) 
    ];
  console.log(selectedData.name);
  console.log(new Date().toLocaleString().replace(",", ""));
  var chats = JSON.parse(localStorage.getItem("chatList")) ? JSON.parse(localStorage.getItem("chatList")) : [];
  function messgaeStore(){
    //   console.log("Hello")
      
      var inputBox = document.getElementById("chatM").value;
      var newChat = {
          "inputBox":inputBox,
          "time":new Date().toLocaleString().replace(",", "")
      }
      chats.push(newChat);
      var chatString = JSON.stringify(chats);
        localStorage.setItem("chatList", chatString);
      
  }
  console.log(chats);
   var content = "";
   for(i=0;i<chats.length;i++){
    //    console.log("heloo")
        content+= "<tr>";
        content+="<td>" + "["+ chats[i].time + "]" +"</td>";
        content+="<td>" + selectedData.name + ": " +"</td>";
        content+="<td> " + chats[i].inputBox +"</td>";
        content+= "<tr>";
   }
   document.getElementById("tabledata").innerHTML = content
    </script>

</html>